<!DOCTYPE html>
<html>
<head>
<title>Registration Form</title>
<link rel="stylesheet" href="/static/css/style.css">
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
    <form action="/register/" method="post">
        <h2>Registration Form</h2>
        <div class="form-item">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div class="form-item">
            <label for="age">Age:</label>
            <input type="number" id="age" name="age" min="0" required>
        </div>
        <div class="form-item">
            <label for="phno">Phone Number:</label>
            <input type="tel" id="phno" name="phno" pattern="[0-9]{10}" required>
        </div>
        <div class="form-item">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
        </div>
        <div class="form-item">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <div class="form-item">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="form-item">
            <label for="dob">Date of Birth:</label>
            <input type="date" id="dob" name="dob" required>
        </div>
        <input type="reset" value="Reset">
        <input type="submit" value="Next">
        
    </form>



 {# SweetAlert2 pop up to check the phone number exists #} 
    <script>
        document.querySelector('form').addEventListener('submit', function(e) {
            e.preventDefault(); // Prevent the default form submission
        
            const formData = new FormData(this);
            fetch('/register/', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if(data.error) {
                    // User exists, show SweetAlert2 popup
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: data.error
                    });
                } else {
                    // User registered, redirect or show success message
                    Swal.fire({
                        icon: 'success',
                        title: 'Registered!',
                        text: 'You have been registered successfully.'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = '/id'; // Redirect to ID form or any other page
                        }
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                // Show error alert
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Something went wrong!'
                });
            });
        });
        </script>
        




</body>
</html>
